(this.webpackJsonpmy_game=this.webpackJsonpmy_game||[]).push([[0],{153:function(e,t,n){},157:function(e,t,n){},275:function(e,t,n){},276:function(e,t,n){},278:function(e,t,n){"use strict";n.r(t);var r,a,c=n(0),i=n.n(c),o=n(12),s=n.n(o),l=n(309),u=(n(153),n(13)),d=(n(157),n(35)),j=n(313),b=n(311),h=n(312),O=n(314),f=n(9),m=n(136),p=n(310),v=n(2),g=function(e){var t=e.label,n=e.input,r=e.meta,a=r.touched,c=r.invalid,i=r.error,o=Object(m.a)(e,["label","input","meta"]);return Object(v.jsx)(p.a,Object(f.a)(Object(f.a)({variant:"outlined",label:t,error:a&&c,helperText:a&&i},n),o))},x=function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e>n.trim().length)return t||"Too few characters in the field. Min length ".concat(e)}},y=function(e,t){return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!e.test(n.trim()))return t||"Value is incorrect. ".concat(e)}},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!e.trim())return"Field is required"},N=function(e){var t=0;if(t+=/[a-z]/.test(e)?1:0,t+=/[A-Z]/.test(e)?1:0,(t+=/\d/.test(e)?1:0)<3)return"Password is not strong"},_=Object(b.a)({form:"login"})((function(e){var t=e.setStateForm,n=e.handleSubmit;return Object(v.jsxs)("form",{onSubmit:n,className:"form",children:[Object(v.jsx)("h2",{className:"form__title",children:"Login"}),Object(v.jsx)(j.a,{validate:[w],name:"login",label:"Login/email",component:g}),Object(v.jsx)(j.a,{validate:[w],name:"password",type:"password",label:"Password",component:g}),Object(v.jsx)(h.a,{children:Object(v.jsx)(O.a,{className:"form__btn",variant:"contained",type:"submit",children:"Login"})}),Object(v.jsx)(h.a,{children:Object(v.jsx)(O.a,{className:"form__btn",variant:"contained",onClick:function(){return t(!1)},children:"Register"})})]})})),S=x(2),C=x(5),R=x(8),k=y(/^[a-z@.]{2,15}$/),T=y(/^[A-Za-z][A-Za-z0-9_]{5,15}$/),F=y(/^[a-zA-Z0-9]{8,15}$/),E=(r=15,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(r<e.trim().length)return a||"There are too many characters in the field. Max length ".concat(r)}),L=Object(b.a)({form:"register"})((function(e){var t=e.setStateForm,n=e.handleSubmit;return Object(v.jsxs)("form",{onSubmit:n,className:"form",children:[Object(v.jsx)("h2",{className:"form__title",children:"Register"}),Object(v.jsx)(j.a,{validate:[w,C,E,T],name:"name",label:"Name",component:g}),Object(v.jsx)(j.a,{validate:[w,S,E,k],name:"login",label:"Login/email",component:g}),Object(v.jsx)(j.a,{validate:[w,R,E,F,N],name:"password",type:"password",label:"Password",component:g}),Object(v.jsx)(h.a,{children:Object(v.jsx)(O.a,{className:"form__btn",variant:"contained",type:"submit",children:"Register"})}),Object(v.jsx)(h.a,{children:Object(v.jsx)(O.a,{className:"form__btn",variant:"contained",onClick:function(){return t(!0)},children:"Login"})})]})})),M=n(74),P=n.n(M),I="START",z="PAUSE",A="TIME",D="POINTS",U="LOGIN",Z="LOGOUT",W="RECORDS",$="http://localhost:3001/",B=P.a.create({baseURL:$,timeout:1e3,headers:{"Content-Type":"application/json;charset=utf-8"}}),G=(n(275),function(e){return{type:I,status:e}}),H=function(e){return{type:D,points:e}},J=function(e){return{type:U,id:e}},q=function(){return{type:Z}},K=function(e,t){return{type:W,records:e,user:t}},V=function(){var e=Object(c.useState)(!0),t=Object(d.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(!1),i=Object(d.a)(a,2),o=i[0],s=i[1],l=Object(c.useState)(!1),j=Object(d.a)(l,2),b=j[0],h=j[1],O=Object(u.c)();Object(c.useEffect)((function(){s(!1),h(!1)}),[n]);return Object(v.jsxs)(v.Fragment,{children:[n?Object(v.jsx)(_,{onSubmit:function(e){var t;(t=e,B.post("login",t)).then((function(e){O(J(e.data.userId))})).catch((function(e){var t=e.response;console.log(t),400===(null===t||void 0===t?void 0:t.status)?s(!0):h(!0)}))},setStateForm:r}):Object(v.jsx)(L,{onSubmit:function(e){var t;(t=e,B.post("register",t)).then((function(e){O(J(e.data.userId))})).catch((function(e){var t=e.response;400===(null===t||void 0===t?void 0:t.status)?s(!0):h(!0)}))},setStateForm:r}),Object(v.jsxs)("div",{className:"error",children:[o&&n?Object(v.jsx)("p",{children:"Login error. Incorrect password or login"}):"",o&&!n?Object(v.jsx)("p",{children:"login is already taken"}):"",b?Object(v.jsx)("p",{children:"Server error"}):""]})]})},Y=P.a.create({baseURL:$+"records/",timeout:1e3,headers:{"Content-Type":"application/json;charset=utf-8"}}),Q=function(e){return Y.post("get",{id:e})},X=n(308),ee=n(319),te=n(315),ne=function(){return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)("p",{children:'The essence of the game is as follows: On the field, on which "cubes" are located in random order, there are colored blocks. Cubes are removed from the field by hovering the cursor over the cube and then clicking the left mouse button.'})})},re=Object(X.a)((function(e){return Object(ee.a)({modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3),top:"".concat(50,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -",50,"%)"),position:"absolute",width:400}})})),ae={Description:ne},ce=function(e){var t=e.handleOpen,n=e.handleClose,r=e.body,a=re(),c=ae[r];return Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(te.a,{open:t,onClose:n,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description",children:Object(v.jsx)("div",{className:a.paper,children:c?Object(v.jsx)(c,{}):Object(v.jsx)("p",{children:"ERROR: Modal window is not defined"})})})})},ie=function(e){var t=e.setModal,n=e.modal,r=Object(u.d)((function(e){return e.game})).points,a=Object(u.d)((function(e){return e.auth})).id,c=Object(u.c)();return Object(v.jsx)(v.Fragment,{children:n.final?Object(v.jsx)("div",{className:"final",children:Object(v.jsxs)("div",{className:"final__body",children:[Object(v.jsx)("h2",{children:"game over"}),Object(v.jsxs)("p",{children:["Points: ",r]}),Object(v.jsx)(O.a,{variant:"contained",color:"primary",onClick:function(){var e;(e={id:a,points:r},Y.post("set",e)).then((function(){t(Object(f.a)(Object(f.a)({},n),{},{final:!1})),Q(a).then((function(e){c(K(e.data.records,e.data.user))})).catch((function(e){var t=e.response;t&&(402===(null===t||void 0===t?void 0:t.status)?(c(q()),alert("ERROR: Not correct user token")):alert("servet error"))}))})).catch((function(e){var t=e.response;t&&(402===(null===t||void 0===t?void 0:t.status)?(c(q()),alert("ERROR: Not correct user token")):alert("servet error"))}))},children:"Save"}),Object(v.jsx)(O.a,{variant:"contained",color:"primary",onClick:function(){t(Object(f.a)(Object(f.a)({},n),{},{final:!1}))},children:"Not save"})]})}):""})},oe={revers:!0,timeout:5},se=function(){var e=Object(c.useState)({flag:!1,view:"Description",final:!1}),t=Object(d.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)({timeout:60,id:null}),i=Object(d.a)(a,2),o=i[0],s=i[1];Object(c.useEffect)((function(){s(Object(f.a)(Object(f.a)({},o),{},{timeout:oe.timeout}))}),[oe]);var l=Object(u.c)(),j=Object(u.d)((function(e){return e.game})),b=j.start,h=j.pause,m=j.points,p=Math.floor(o.timeout/60),g=o.timeout%60,x="".concat(Math.floor(p/10)?p:"0"+p,":").concat(Math.floor(g/10)?g:"0"+g);return Object(c.useEffect)((function(){b&&!h?(0===o.timeout&&(clearTimeout(o.id),r(Object(f.a)(Object(f.a)({},n),{},{final:!0})),l(G(!1)),s({timeout:60,id:null})),setTimeout((function(){0!==o.timeout&&s(oe.revers?Object(f.a)(Object(f.a)({},o),{},{timeout:o.timeout-1}):Object(f.a)(Object(f.a)({},o),{},{timeout:o.timeout+1}))}),1e3)):clearTimeout(o.id)}),[o,b,h]),Object(v.jsxs)("header",{className:"header",children:[Object(v.jsx)(ie,{modal:n,setModal:r}),Object(v.jsx)(ce,{body:n.view,handleClose:function(){return r(Object(f.a)(Object(f.a)({},n),{},{flag:!1}))},handleOpen:n.flag}),Object(v.jsx)("h1",{className:"header__title",children:"Kill The Cube"}),Object(v.jsxs)("div",{className:"header__btn-gryp",children:[Object(v.jsx)("input",{type:"text",value:x,disabled:!0,className:"header__input"}),Object(v.jsxs)(O.a,{variant:"contained",color:"primary",onClick:function(){return l(G(!b))},children:[b?"END game":"Start"," "]}),Object(v.jsx)(O.a,{variant:"contained",color:"primary",disabled:!b,onClick:function(){return l(function(e){return{type:z,status:e}}(!h))},children:h?"Proceed":"Stop"}),Object(v.jsx)("input",{type:"text",value:"".concat(m," points"),disabled:!0,className:"header__input"}),Object(v.jsx)(O.a,{className:"header__btn",variant:"contained",color:"primary",onClick:function(){return r(Object(f.a)(Object(f.a)({},n),{},{view:"Description",flag:!0}))},children:"description"}),Object(v.jsx)(O.a,{variant:"contained",color:"primary",onClick:function(){l(q())},children:"Logout"})]}),Object(v.jsx)("img",{className:"header__logo",src:"/logo.png",alt:"logo"})]})},le=["green","blue","red"],ue=function(e){var t=e.variant,n=e.hp,r=void 0===n?0:n,a=e.id,c=e.coordinates,i=e.rotation;return Object(v.jsx)("div",{id:"".concat(a),style:c,className:"".concat(le[t]," cube ").concat(i?"rotation":""),children:r?r+1:""})},de=function(e,t){return Math.round(Math.random()*(e-t)+t)},je=function(e,t){var n=e.width,r=e.heigth,a=de(t.hp-1,0),c=de(t.numberOptions-1,0);return{hp:a,variant:c,points:a?Math.round(.5*a+c+1):c+1,coordinates:{left:de(n-25,25),top:de(r-25,25)}}},be=function(e,t,n){for(var r=de(n.max,n.min);e.length<r;)e.push(je(t,n));return e},he=function(){var e=Object(c.useState)({cubes:[],warning:!1}),t=Object(d.a)(e,2),n=t[0],r=t[1],a=Object(u.c)(),i=Object(u.d)((function(e){return e.game})),o=i.start,s=i.pause,l=i.points,j=Object(c.useRef)(),b={hp:2,min:1,max:6,numberOptions:3,time:60,rotation:!0};return Object(c.useEffect)((function(){o?(a(H(0)),r({cubes:be([],{width:j.current.clientWidth,heigth:j.current.clientHeight},b),warning:!1})):r({cubes:[],warning:!1})}),[o]),window.addEventListener("resize",(function(){o&&(a(G(!1)),r({cubes:[],warning:!0}))})),Object(v.jsxs)("div",{ref:j,className:"gameField",onClick:function(e){var t=e.target;if((t.id||0===t.id)&&o&&!s){var c,i,u=[];if(Object.assign(u,n.cubes),n.cubes[t.id].hp<1)return a(H(l+u[t.id].points)),c=u,i=t.id,c.splice(i,1),void r(Object(f.a)(Object(f.a)({},n),{},{cubes:be(u,{width:j.current.clientWidth,heigth:j.current.clientHeight},b)}));--u[t.id].hp,r(Object(f.a)(Object(f.a)({},n),{},{cubes:u}))}},children:[n.cubes.map((function(e,t){return Object(v.jsx)(ue,{hp:e.hp,rotation:b.rotation,variant:e.variant,id:t,coordinates:e.coordinates},t)})),n.warning?Object(v.jsx)("p",{className:"gameField__warning",children:"Warning: Please do not resize the window. if an error occurs reload the page"}):""]})},Oe=function(){var e,t,n=Object(u.d)((function(e){return e.records})),r=n.records,a=n.user;return Object(v.jsxs)("div",{className:"table",children:[Object(v.jsxs)("p",{children:["Your name: ",null!==(e=null===a||void 0===a?void 0:a.name)&&void 0!==e?e:""]}),Object(v.jsxs)("p",{children:["Points: ",null!==(t=null===a||void 0===a?void 0:a.points)&&void 0!==t?t:""]}),Object(v.jsx)("p",{children:"Rating"}),r.map((function(e,t){return Object(v.jsxs)("p",{children:[t+1,".",e.name,": ",e.points]},t)}))]})},fe=(n(276),function(){var e=Object(u.d)((function(e){return e.auth})).id,t=Object(u.c)();return Object(c.useEffect)((function(){setTimeout((function(){Q(e).then((function(e){t(K(e.data.records,e.data.user))})).catch((function(e){var n=e.response;n&&(402===(null===n||void 0===n?void 0:n.status)?t(q()):alert("servet error"))}))}),1e3)}),[]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(se,{}),Object(v.jsxs)("section",{className:"mainSection",children:[Object(v.jsx)(he,{}),Object(v.jsx)(Oe,{})]})]})}),me=n(135),pe=n(16),ve=function(){var e=Object(u.d)((function(e){return e.auth})).id;return Object(v.jsx)("main",{className:"main",children:Object(v.jsx)(me.a,{children:Object(v.jsxs)(pe.d,{children:[Object(v.jsxs)(pe.b,{path:"/",exact:!0,children:[e?"":Object(v.jsx)(pe.a,{to:"/login"}),Object(v.jsx)(fe,{})]}),Object(v.jsxs)(pe.b,{path:"/login",exact:!0,children:[e?Object(v.jsx)(pe.a,{to:"/"}):"",Object(v.jsx)(V,{})]})]})})})},ge=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,320)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))},xe=n(18),ye={start:!1,pause:!1,defult:!0,points:0,time:0},we=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return Object(f.a)(Object(f.a)({},e),{},{pause:!1,start:t.status});case z:return Object(f.a)(Object(f.a)({},e),{},{pause:t.status});case A:return Object(f.a)(Object(f.a)({},e),{},{time:t.time});case D:return Object(f.a)(Object(f.a)({},e),{},{points:t.points});default:return e}},Ne={id:null},_e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Z:return{id:null};case U:return{id:t.id};default:return e}},Se={records:[],user:null},Ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case W:return{records:t.records,user:t.user};default:return e}},Re=n(316),ke=Object(xe.b)({form:Re.a,game:we,auth:_e,records:Ce}),Te=Object(xe.c)(ke);s.a.render(Object(v.jsxs)(i.a.StrictMode,{children:[Object(v.jsx)(l.a,{}),Object(v.jsx)(u.a,{store:Te,children:Object(v.jsx)(ve,{})})]}),document.getElementById("root")),ge()}},[[278,1,2]]]);
//# sourceMappingURL=main.f3890914.chunk.js.map